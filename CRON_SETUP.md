# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

## üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—Å–∏–Ω–≥–∞

### –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–º–∏–Ω–∏–º—É–º 1500 —Ä–µ—Ü–µ–ø—Ç–æ–≤ –≤ —Å—É—Ç–∫–∏)

- **–ß–∞—Å—Ç–æ—Ç–∞**: –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞ —Ä–∞–∑**: 32 —Ä–µ—Ü–µ–ø—Ç–∞
- **–ò—Ç–æ–≥–æ –≤ —Å—É—Ç–∫–∏**: 48 –∑–∞–ø—É—Å–∫–æ–≤ √ó 32 = **1536 —Ä–µ—Ü–µ–ø—Ç–æ–≤**

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ web-—Ö–æ—Å—Ç–∏–Ω–≥–µ

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `schedule.sh` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
2. –ò–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É:
   ```bash
   cd /home/username/domains/im-edok.ru/public_html || exit
   ```
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
   ```bash
   chmod +x schedule.sh
   ```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CRON –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

–í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö–æ—Å—Ç–∏–Ω–≥–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, ISPmanager, cPanel) –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–∞–Ω–∏–µ cron:

```
*/1 * * * * /home/username/domains/im-edok.ru/public_html/schedule.sh
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**:
- `*/1 * * * *` - –∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- Laravel Scheduler —Å–∞–º —Ä–µ—à–∞–µ—Ç, –∫–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å –∑–∞–¥–∞—á–∏ (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç –¥–ª—è –ø–∞—Ä—Å–µ—Ä–∞)

### –®–∞–≥ 3: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ artisan)

–ï—Å–ª–∏ —Ö–æ—Å—Ç–∏–Ω–≥ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç bash-—Å–∫—Ä–∏–ø—Ç—ã:

```
*/1 * * * * cd /home/username/domains/im-edok.ru/public_html && php artisan schedule:run >> /dev/null 2>&1
```

## ‚öôÔ∏è –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞

### –ü–∞—Ä—Å–∏–Ω–≥ —Ç–æ—á–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤:

```bash
# 30 —Ä–µ—Ü–µ–ø—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
php artisan recipes:parse

# 50 —Ä–µ—Ü–µ–ø—Ç–æ–≤
php artisan recipes:parse --count=50

# 100 —Ä–µ—Ü–µ–ø—Ç–æ–≤
php artisan recipes:parse --count=100
```

### –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:

```bash
# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (5 —Ä–µ—Ü–µ–ø—Ç–æ–≤)
php artisan recipes:parse --count=5

# –°—Ä–µ–¥–Ω—è—è –∑–∞–≥—Ä—É–∑–∫–∞ (32 —Ä–µ—Ü–µ–ø—Ç–∞ - –∫–∞–∫ –≤ cron)
php artisan recipes:parse --count=32

# –ë–æ–ª—å—à–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (100 —Ä–µ—Ü–µ–ø—Ç–æ–≤)
php artisan recipes:parse --count=100

# –ú–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (500 —Ä–µ—Ü–µ–ø—Ç–æ–≤)
php artisan recipes:parse --count=500
```

## üìà –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –≤ —Å—É—Ç–∫–∏

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `app/Console/Kernel.php` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `--count`:

### –í–∞—Ä–∏–∞–Ω—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```php
// 1. –ú–∏–Ω–∏–º—É–º 1500 —Ä–µ—Ü–µ–ø—Ç–æ–≤ –≤ —Å—É—Ç–∫–∏ (—Ç–µ–∫—É—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
$schedule->command('recipes:parse --count=32')
    ->everyThirtyMinutes(); // 48 √ó 32 = 1536/–¥–µ–Ω—å

// 2. –ü—Ä–∏–º–µ—Ä–Ω–æ 2400 —Ä–µ—Ü–µ–ø—Ç–æ–≤ –≤ —Å—É—Ç–∫–∏
$schedule->command('recipes:parse --count=50')
    ->everyThirtyMinutes(); // 48 √ó 50 = 2400/–¥–µ–Ω—å

// 3. –ü—Ä–∏–º–µ—Ä–Ω–æ 1920 —Ä–µ—Ü–µ–ø—Ç–æ–≤ –≤ —Å—É—Ç–∫–∏
$schedule->command('recipes:parse --count=40')
    ->everyThirtyMinutes(); // 48 √ó 40 = 1920/–¥–µ–Ω—å

// 4. –ö–∞–∂–¥—ã–π —á–∞—Å –ø–æ 65 —Ä–µ—Ü–µ–ø—Ç–æ–≤ (1560/–¥–µ–Ω—å)
$schedule->command('recipes:parse --count=65')
    ->hourly(); // 24 √ó 65 = 1560/–¥–µ–Ω—å

// 5. –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç –ø–æ 16 —Ä–µ—Ü–µ–ø—Ç–æ–≤ (1536/–¥–µ–Ω—å)
$schedule->command('recipes:parse --count=16')
    ->everyFifteenMinutes(); // 96 √ó 16 = 1536/–¥–µ–Ω—å
```

## üìù –õ–æ–≥–∏ –ø–∞—Ä—Å–µ—Ä–∞

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- `storage/logs/parser.log` - –ª–æ–≥–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `storage/logs/sitemap.log` - –ª–æ–≥–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ sitemap
- `storage/logs/laravel.log` - –æ–±—â–∏–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞ –ø–∞—Ä—Å–µ—Ä–∞
tail -n 50 storage/logs/parser.log

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f storage/logs/parser.log

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
grep "ERROR\|FAIL\|‚ùå" storage/logs/parser.log
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞

### 1. –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ (5 —Ä–µ—Ü–µ–ø—Ç–æ–≤):
```bash
php artisan recipes:parse --count=5
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:
```bash
php artisan schedule:list
```

### 3. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ scheduler:
```bash
php artisan schedule:run
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –≤ –ë–î:
```bash
php artisan tinker
>>> \App\Models\Recipe::count()
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. **–ü–∞—Ä—Å–µ—Ä –∏—â–µ—Ç –¢–û–ß–ù–û–ï –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ü–µ–ø—Ç–æ–≤**
   - –ï—Å–ª–∏ –≤—ã –∑–∞–ø—Ä–æ—Å–∏—Ç–µ 32 —Ä–µ—Ü–µ–ø—Ç–∞, –ø–∞—Ä—Å–µ—Ä –Ω–∞–π–¥–µ—Ç —Ä–æ–≤–Ω–æ 32 –ù–û–í–´–• —Ä–µ—Ü–µ–ø—Ç–∞
   - –†–µ—Ü–µ–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
   - –ü–∞—Ä—Å–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ—Ç –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ

### 2. **–ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `source_url`
   - –ï—Å–ª–∏ —Ä–µ—Ü–µ–ø—Ç —É–∂–µ –≤ –±–∞–∑–µ - –æ–Ω –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
   - –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ —Å–∫–æ–ª—å–∫–æ URL –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Å–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö –Ω–∞–π–¥–µ–Ω–æ

### 3. **–ó–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏**
   - 1-3 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É —Ä–µ—Ü–µ–ø—Ç–∞–º–∏ (—Å–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞)
   - 2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
   - –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∏—Å—Ç–æ—á–Ω–∏–∫–∞

### 4. **–õ–∏–º–∏—Ç—ã**
   - –ú–∞–∫—Å–∏–º—É–º 100 —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–æ–≤—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤
   - –ï—Å–ª–∏ –ø–æ—Å–ª–µ 100 —Å—Ç—Ä–∞–Ω–∏—Ü –Ω–µ –Ω–∞–±—Ä–∞–ª–æ—Å—å –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ - –ø–∞—Ä—Å–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ü–µ–ª–µ–π

### –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–æ—Å—Ç (3000+ —Ä–µ—Ü–µ–ø—Ç–æ–≤/–¥–µ–Ω—å):
```php
$schedule->command('recipes:parse --count=65')
    ->everyThirtyMinutes(); // 48 √ó 65 = 3120/–¥–µ–Ω—å
```

### –£–º–µ—Ä–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç (1500-2000 —Ä–µ—Ü–µ–ø—Ç–æ–≤/–¥–µ–Ω—å):
```php
$schedule->command('recipes:parse --count=32')
    ->everyThirtyMinutes(); // 48 √ó 32 = 1536/–¥–µ–Ω—å
```

### –≠–∫–æ–Ω–æ–º–Ω—ã–π —Ä–µ–∂–∏–º (500-1000 —Ä–µ—Ü–µ–ø—Ç–æ–≤/–¥–µ–Ω—å):
```php
$schedule->command('recipes:parse --count=20')
    ->hourly(); // 24 √ó 20 = 480/–¥–µ–Ω—å

// –∏–ª–∏
$schedule->command('recipes:parse --count=40')
    ->everyTwoHours(); // 12 √ó 40 = 480/–¥–µ–Ω—å
```

### –ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º (–ø–∞—Ä—Å–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –Ω–æ—á—å—é):
```php
$schedule->command('recipes:parse --count=100')
    ->hourly()
    ->between('00:00', '06:00'); // 6 —á–∞—Å–æ–≤ √ó 100 = 600/–Ω–æ—á—å
```

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü–∞—Ä—Å–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: `chmod +x schedule.sh`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ PHP: `which php`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ cron: `crontab -l`

### –ù–µ –≤—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f storage/logs/parser.log`
2. –í–æ–∑–º–æ–∂–Ω–æ –∏—Å—Ç–æ—á–Ω–∏–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª IP - —É–≤–µ–ª–∏—á—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Ä—É—á–Ω—É—é –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: `php artisan recipes:parse --count=5`

### –†–µ—Ü–µ–ø—Ç—ã –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è:
- –≠—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è –ø—Ä–æ–≤–µ—Ä–∫–µ `source_url` –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
- –ï—Å–ª–∏ –≤—Å—ë –∂–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –≤ –ë–î

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `storage/logs/parser.log`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥: `php artisan recipes:parse --count=5`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ: `php artisan schedule:list`
